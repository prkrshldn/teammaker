<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="assets/css/loadmaker.css">
    <link rel="stylesheet" href="assets/css/maker.css">
    <link rel="stylesheet" href="assets/css/dd.css">
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Open+Sans:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&amp;family=Droid+Sans+Mono&amp;family=Source+Code+Pro:wght@400;700&amp;display=swap">
</head>

<body onload="menu()">
    <div class="grid">
        <fun>
            <h1>REMOTE CONTROL</h1>
        </fun>
        <fun>
            <label>Logo: </label>
            <span id="logo"></span>
            <textarea class="textfun" id="teamname"></textarea>
            <br>
            <label>Region: </label>
            <span id="flag-name"></span>
            <br>
            <label>Tag: </label>
            <textarea class="textfun" id="t1tag-ta"></textarea>
            <br>
            <label>Player 1: </label>
            <span id="flagp1"></span>
            <textarea class="textfun" id="t1p1-ta"></textarea>
            <br>
            <label>Player 2: </label>
            <span id="flagp2"></span>
            <textarea class="textfun" id="t1p2-ta"></textarea>
            <br>
            <label>Player 3: </label>
            <span id="flagp3"></span>
            <textarea class="textfun" id="t1p3-ta"></textarea>
            <br>
            <label>Coach 1</label>
            <input type="checkbox" name="Coach 1" id="coach1">
            <span id="flagc1"></span>
            <textarea class="textfun" id="t1c1-ta"></textarea>
            <br>
            <label>Coach 2</label>
            <input type="checkbox" name="Coach 2" id="coach2">
            <span id="flagc2"></span>
            <textarea class="textfun" id="t1c2-ta"></textarea>
            <br>
            <label>Coach 3</label>
            <input type="checkbox" name="Coach 3" id="coach3">
            <span id="flagc3"></span>
            <textarea class="textfun" id="t1c3-ta"></textarea>
            <br>
            <br>
            <button id="update">UPDATE IT!</button>
            <br>
            <button onclick="myFunction3()">COPY THE URL MF</button>
            <button onclick="FUCKFUCKPUSSYPUSSYSHITSHITSHIT()">IMPORT BRACKET</button>
        </fun>
        <fun>
            <textarea style="width: 38%;" name="" id="urltext"></textarea>
            <textarea style="width: 58%;" name="" id="importtext"></textarea>
        </fun>
    </div>
    <script>
        // Function to send a message to the opener window
        function sendMessageToOpener(action, value) {
            if (window.opener) {
                const message = { action: action, value: value };
                window.opener.postMessage(message, window.location.origin);
            }
        }
        let envelope;
        let frontflip;
        let k = [];
        let dir = "assets/img/flags";
        let fileex = ".png";
        let query = new URLSearchParams(window.location.search);
        let team1 = document.getElementById("team1");
        let team2 = document.getElementById("team2");
        let t1cont = document.getElementById("t1cont");
        let t1name = document.getElementById("t1name");
        let t1logo = document.getElementById("t1logo");
        let t1p1 = document.getElementById("t1p1");
        let t1p2 = document.getElementById("t1p2");
        let t1p3 = document.getElementById("t1p3");
        let t1c1 = document.getElementById("t1c1");
        let t1c2 = document.getElementById("t1c2");
        let t1c3 = document.getElementById("t1c3");
        let t1p1flag = document.getElementById("t1p1-flag");
        let t1p2flag = document.getElementById("t1p2-flag");
        let t1p3flag = document.getElementById("t1p3-flag");
        let t1c1flag = document.getElementById("t1c1-flag");
        let t1c2flag = document.getElementById("t1c2-flag");
        let t1c3flag = document.getElementById("t1c3-flag");
        let t1tag = document.getElementById("t1tag");
        function menu() {
            fetch(`assets/json/logo.json`)
                .then(function (response) {
                    return response.json();
                })
                .then(function (data) {
                    rg(data);
                })
                .catch(function (err) {
                    console.log("error: " + err);
                });
            /**
             * This is the rg function
             * @description - It takes the data from gs.json and helps send the user to the randomly chosen game.
             * @param {*} data - the data that is being passed through.
             */
            function rg(data) {
                console.log(data);
                MsDropdown.make("#logo", {
                    byJson: {
                        data: data, selectedIndex: 0, width: 200
                    },
                    childHeight: 115,
                    enableCheckbox: false
                });
                $.ajax({
                    //This will retrieve the contents of the folder if the folder is configured as 'browsable'
                    url: dir,
                    success: function (data) {
                        //List all .png file names in the page
                        $(data).find("a:contains(" + fileex + ")").each(function () {
                            var filename = this.href.replace(window.location.host, "").replace("http://", "");
                            k.push(
                                {
                                    "text": filename.replaceAll("/assets/img/flags/", ""),
                                    "value": `..${filename}`,
                                    "image": `..${filename}`
                                }
                            )
                        });
                        MsDropdown.make("#flag-name", {
                            byJson: {
                                data: k, selectedIndex: 0, width: 200
                            },
                            childHeight: 115,
                            enableCheckbox: false
                        });
                        MsDropdown.make("#flagp1", {
                            byJson: {
                                data: k, selectedIndex: 0, width: 200
                            },
                            childHeight: 115,
                            enableCheckbox: false
                        });
                        MsDropdown.make("#flagp2", {
                            byJson: {
                                data: k, selectedIndex: 0, width: 200
                            },
                            childHeight: 115,
                            enableCheckbox: false
                        });
                        MsDropdown.make("#flagp3", {
                            byJson: {
                                data: k, selectedIndex: 0, width: 200
                            },
                            childHeight: 115,
                            enableCheckbox: false
                        });
                        MsDropdown.make("#flagc1", {
                            byJson: {
                                data: k, selectedIndex: 0, width: 200
                            },
                            childHeight: 115,
                            enableCheckbox: false
                        });
                        MsDropdown.make("#flagc2", {
                            byJson: {
                                data: k, selectedIndex: 0, width: 200
                            },
                            childHeight: 115,
                            enableCheckbox: false
                        });
                        MsDropdown.make("#flagc3", {
                            byJson: {
                                data: k, selectedIndex: 0, width: 200
                            },
                            childHeight: 115,
                            enableCheckbox: false
                        });
                    }
                });
            }
            $("#logo").click(function () {
                document.getElementById('teamname').value = $('#logo option:selected').text();
            });
            $("#update").click(function () {
                envelope = `${$('#logo option:selected').data('image')}|${$('#flag-name option:selected').data('image')}|${document.getElementById('teamname').value}|${document.getElementById('t1p1-ta').value}|${$('#flagp1 option:selected').data('image')}|${document.getElementById('t1p2-ta').value}|${$('#flagp2 option:selected').data('image')}|${document.getElementById("t1p3-ta").value}|${$('#flagp3 option:selected').data('image')}|${document.getElementById('t1tag-ta').value}|${document.getElementById("coach1").checked}|${$('#flagc1 option:selected').data('image')}|${document.getElementById('t1c1-ta').value}|${document.getElementById("coach2").checked}|${$('#flagc2 option:selected').data('image')}|${document.getElementById('t1c2-ta').value}|${document.getElementById("coach3").checked}|${$('#flagc3 option:selected').data('image')}|${document.getElementById('t1c3-ta').value}`;
                frontflip = `${document.getElementById("logo").msDropdown.selectedIndex}|${document.getElementById("flag-name").msDropdown.selectedIndex}|${document.getElementById("teamname").value}|${document.getElementById("flagp1").msDropdown.selectedIndex}|${document.getElementById("t1p1-ta").value}|${document.getElementById("flagp2").msDropdown.selectedIndex}|${document.getElementById("t1p2-ta").value}|${document.getElementById("flagp3").msDropdown.selectedIndex}|${document.getElementById("t1p3-ta").value}|${document.getElementById("coach1").checked}|${document.getElementById("t1c1-ta").value}|${document.getElementById("flagc1").msDropdown.selectedIndex}|${document.getElementById("coach2").checked}|${document.getElementById("t1c2-ta").value}|${document.getElementById("flagc2").msDropdown.selectedIndex}|${document.getElementById("coach3").checked}|${document.getElementById("t1c3-ta").value}|${document.getElementById("flagc3").msDropdown.selectedIndex}|${document.getElementById("t1tag-ta").value}`
                document.getElementById("importtext").innerText = btoa(frontflip);
                sendMessageToOpener("changeValues", envelope);
            });
        }

    </script>
    <script src="assets/js/dd.min.js"></script>
</body>

</html>